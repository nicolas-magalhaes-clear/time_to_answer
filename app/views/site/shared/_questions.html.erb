<script>

function validAnswer(questionId){
  
  const question = document.querySelector(`#question-${questionId}`)

  const answers = question.querySelectorAll('input[type=radio]')
  
  const button = question.querySelector('button')

  console.log('button', button)
  
  console.log('inputs:', answers)
  


  let selectedAnswer;

  answers.forEach(answer => {
    if(answer.checked){
      selectedAnswer = answer
    }
  })

  if(selectedAnswer.value === 'true'){
    button.classList.remove('btn-default')
    button.classList.remove('bg-danger')
    button.classList.add('bg-success')
  }
  else{
    button.classList.remove('btn-default')
    button.classList.add('bg-danger')
    button.classList.remove('bg-success')
  }

  


}

</script>

<!-- Main component for a primary marketing message or call to action -->
<div class="jumbotron">
  <% unless params[:term] %>
    <h3>Ãšltimas perguntas cadastradas...</h3>
  <% else %>
    <h3><%= "Resultados  para o termo \"#{params[:term]}\"..."%></h3>
  <% end %>
</div>
<% @questions.each do |question| %>
    <%= form_with url: site_answer_path do |form| %>
    <div class="panel panel-default" id="question-<%= question.id %>">
      <div class="panel-heading">
        <h3 class="panel-title"><%= question.description %></h3>
      </div>
      <div class="panel-body">
        <ul>
          <% question.answers.each do |answer| %>
            <li  style="list-style:none;" >
              <div class="radio">
                <label class="label-resposta"  >
                  <%= radio_button_tag 'answer_id', answer.id, value: "#{answer.correct}" %>
                  <%= answer.description %>
                </label>
              </div>
            </li>
            
          <% end %>
          <li style="list-style:none;">
           <button type="button" onClick="validAnswer('<%= question.id %>')"  class="btn btn-default">Responder</button>
          </li>
        </ul>
      </div>
    </div>
  <% end %>
<% end %>
<div class="text-center">
  <%= paginate @questions %>
</div>
 
